n=0; farx(n+1)=1.121081e+004; foe(n+1)=1.109454e+004; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.454973e+003; foe(n+1)=8.429866e+003; krok(n+1)=2.424272e-004; ng(n+1)=2.138458e+004;
n=2; farx(n+1)=1.755237e+003; foe(n+1)=1.892887e+004; krok(n+1)=7.964429e-005; ng(n+1)=3.066837e+004;
n=3; farx(n+1)=6.397551e+002; foe(n+1)=2.172535e+004; krok(n+1)=2.601242e-004; ng(n+1)=9.720514e+003;
n=4; farx(n+1)=1.082151e+002; foe(n+1)=1.720896e+004; krok(n+1)=2.086706e-003; ng(n+1)=7.322511e+003;
n=5; farx(n+1)=8.150654e+001; foe(n+1)=1.662380e+004; krok(n+1)=6.191918e-004; ng(n+1)=1.334228e+003;
n=6; farx(n+1)=5.951880e+001; foe(n+1)=1.159966e+004; krok(n+1)=8.374265e-004; ng(n+1)=2.011767e+003;
n=7; farx(n+1)=3.690830e+001; foe(n+1)=2.005430e+003; krok(n+1)=3.023106e-003; ng(n+1)=5.496520e+002;
n=8; farx(n+1)=2.801975e+001; foe(n+1)=1.821020e+003; krok(n+1)=1.849454e-003; ng(n+1)=8.699950e+002;
n=9; farx(n+1)=2.076914e+001; foe(n+1)=9.947245e+002; krok(n+1)=5.320104e-003; ng(n+1)=7.977643e+002;
n=10; farx(n+1)=1.511288e+001; foe(n+1)=5.902751e+002; krok(n+1)=9.272824e-004; ng(n+1)=1.030005e+003;
n=11; farx(n+1)=8.198177e+000; foe(n+1)=3.134878e+002; krok(n+1)=6.947618e-003; ng(n+1)=4.934218e+002;
n=12; farx(n+1)=4.613809e+000; foe(n+1)=1.707269e+002; krok(n+1)=7.431661e-003; ng(n+1)=3.921353e+002;
n=13; farx(n+1)=3.652586e+000; foe(n+1)=1.243058e+002; krok(n+1)=5.022246e-003; ng(n+1)=2.093292e+002;
n=14; farx(n+1)=2.972357e+000; foe(n+1)=1.221465e+002; krok(n+1)=7.780842e-003; ng(n+1)=4.097596e+002;
n=15; farx(n+1)=2.114932e+000; foe(n+1)=9.537525e+001; krok(n+1)=8.516524e-003; ng(n+1)=2.938325e+002;
n=16; farx(n+1)=1.664716e+000; foe(n+1)=5.586046e+001; krok(n+1)=1.619492e-001; ng(n+1)=7.134729e+001;
n=17; farx(n+1)=1.579702e+000; foe(n+1)=5.356619e+001; krok(n+1)=9.146433e-003; ng(n+1)=1.065975e+002;
n=18; farx(n+1)=1.350631e+000; foe(n+1)=4.841298e+001; krok(n+1)=3.550149e-002; ng(n+1)=1.854482e+002;
n=19; farx(n+1)=1.190953e+000; foe(n+1)=4.912226e+001; krok(n+1)=2.085765e-002; ng(n+1)=5.420386e+001;
n=20; farx(n+1)=1.082898e+000; foe(n+1)=7.492722e+001; krok(n+1)=3.085256e-002; ng(n+1)=1.491534e+002;
n=21; farx(n+1)=7.094377e-001; foe(n+1)=9.084850e+001; krok(n+1)=9.091272e-002; ng(n+1)=1.789631e+002;
n=22; farx(n+1)=6.522033e-001; foe(n+1)=1.237435e+002; krok(n+1)=2.598758e-002; ng(n+1)=1.830134e+002;
n=23; farx(n+1)=5.177218e-001; foe(n+1)=1.882170e+002; krok(n+1)=8.005809e-002; ng(n+1)=1.578796e+002;
n=24; farx(n+1)=4.543104e-001; foe(n+1)=1.703202e+002; krok(n+1)=1.269085e-001; ng(n+1)=3.310682e+001;
n=25; farx(n+1)=3.899522e-001; foe(n+1)=1.988528e+002; krok(n+1)=3.881773e-001; ng(n+1)=6.172659e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.860919e-001; foe(n+1)=2.047807e+002; krok(n+1)=2.656342e-005; ng(n+1)=5.435009e+001;
n=27; farx(n+1)=3.804159e-001; foe(n+1)=2.071944e+002; krok(n+1)=1.107642e-004; ng(n+1)=3.636828e+001;
n=28; farx(n+1)=3.736953e-001; foe(n+1)=1.995751e+002; krok(n+1)=1.704574e-003; ng(n+1)=8.891736e+000;
n=29; farx(n+1)=3.607408e-001; foe(n+1)=1.729808e+002; krok(n+1)=2.926191e-003; ng(n+1)=1.028857e+001;
n=30; farx(n+1)=3.406928e-001; foe(n+1)=1.031090e+002; krok(n+1)=9.251671e-003; ng(n+1)=7.634410e+000;
n=31; farx(n+1)=3.186914e-001; foe(n+1)=1.684298e+002; krok(n+1)=1.308935e-002; ng(n+1)=1.007864e+001;
n=32; farx(n+1)=2.959671e-001; foe(n+1)=1.267887e+002; krok(n+1)=1.931884e-002; ng(n+1)=4.239120e+001;
n=33; farx(n+1)=2.741734e-001; foe(n+1)=8.969831e+001; krok(n+1)=1.057221e-001; ng(n+1)=1.027516e+002;
n=34; farx(n+1)=2.510590e-001; foe(n+1)=6.213886e+001; krok(n+1)=5.184392e-002; ng(n+1)=6.741235e+001;
n=35; farx(n+1)=2.297544e-001; foe(n+1)=7.355123e+001; krok(n+1)=4.895097e-002; ng(n+1)=1.040175e+002;
n=36; farx(n+1)=2.023420e-001; foe(n+1)=5.808130e+001; krok(n+1)=1.218112e-001; ng(n+1)=4.492326e+001;
n=37; farx(n+1)=1.893472e-001; foe(n+1)=6.784907e+001; krok(n+1)=8.153064e-002; ng(n+1)=5.343123e+001;
n=38; farx(n+1)=1.702613e-001; foe(n+1)=5.293328e+001; krok(n+1)=1.158784e-001; ng(n+1)=2.570760e+001;
n=39; farx(n+1)=1.615368e-001; foe(n+1)=5.363410e+001; krok(n+1)=1.484819e-001; ng(n+1)=1.217439e+001;
n=40; farx(n+1)=1.446085e-001; foe(n+1)=5.637062e+001; krok(n+1)=5.286105e-002; ng(n+1)=6.639636e+001;
n=41; farx(n+1)=1.226148e-001; foe(n+1)=6.232365e+001; krok(n+1)=3.923690e-001; ng(n+1)=1.132317e+001;
n=42; farx(n+1)=1.089579e-001; foe(n+1)=6.631511e+001; krok(n+1)=6.528949e-002; ng(n+1)=5.541350e+001;
n=43; farx(n+1)=9.610093e-002; foe(n+1)=6.024751e+001; krok(n+1)=5.955282e-002; ng(n+1)=5.112451e+001;
n=44; farx(n+1)=8.320080e-002; foe(n+1)=4.695173e+001; krok(n+1)=2.975743e-001; ng(n+1)=3.545997e+001;
n=45; farx(n+1)=7.746642e-002; foe(n+1)=4.914676e+001; krok(n+1)=1.134226e-001; ng(n+1)=2.603554e+001;
n=46; farx(n+1)=6.844975e-002; foe(n+1)=5.949935e+001; krok(n+1)=1.365319e-001; ng(n+1)=3.475591e+001;
n=47; farx(n+1)=6.189005e-002; foe(n+1)=4.649328e+001; krok(n+1)=2.442288e-001; ng(n+1)=5.887041e+000;
n=48; farx(n+1)=5.369033e-002; foe(n+1)=5.129594e+001; krok(n+1)=4.411592e-001; ng(n+1)=5.208220e+000;
n=49; farx(n+1)=5.238567e-002; foe(n+1)=5.279682e+001; krok(n+1)=1.245141e-001; ng(n+1)=9.928319e+000;
n=50; farx(n+1)=4.982712e-002; foe(n+1)=5.798205e+001; krok(n+1)=2.023747e-001; ng(n+1)=1.608231e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.960283e-002; foe(n+1)=5.830204e+001; krok(n+1)=1.654943e-005; ng(n+1)=1.512090e+001;
n=52; farx(n+1)=4.904388e-002; foe(n+1)=4.802096e+001; krok(n+1)=1.761674e-004; ng(n+1)=8.054560e+000;
n=53; farx(n+1)=4.850921e-002; foe(n+1)=4.242170e+001; krok(n+1)=3.262169e-004; ng(n+1)=6.371345e+000;
n=54; farx(n+1)=4.816339e-002; foe(n+1)=4.763049e+001; krok(n+1)=5.390749e-003; ng(n+1)=1.058941e+000;
n=55; farx(n+1)=4.715271e-002; foe(n+1)=4.820561e+001; krok(n+1)=1.053841e-002; ng(n+1)=1.629467e+000;
n=56; farx(n+1)=4.647503e-002; foe(n+1)=3.774260e+001; krok(n+1)=1.572069e-002; ng(n+1)=7.215883e+000;
n=57; farx(n+1)=4.438815e-002; foe(n+1)=4.560793e+001; krok(n+1)=8.000730e-002; ng(n+1)=9.556816e+000;
n=58; farx(n+1)=4.001230e-002; foe(n+1)=3.549182e+001; krok(n+1)=6.087640e-002; ng(n+1)=1.574789e+001;
n=59; farx(n+1)=3.697019e-002; foe(n+1)=2.849362e+001; krok(n+1)=3.505976e-001; ng(n+1)=3.875576e+001;
n=60; farx(n+1)=3.462920e-002; foe(n+1)=2.601426e+001; krok(n+1)=1.722157e-001; ng(n+1)=1.215192e+001;
n=61; farx(n+1)=3.144328e-002; foe(n+1)=2.452146e+001; krok(n+1)=4.452012e-001; ng(n+1)=1.251831e+001;
n=62; farx(n+1)=3.032218e-002; foe(n+1)=2.152974e+001; krok(n+1)=8.005809e-002; ng(n+1)=1.028106e+001;
n=63; farx(n+1)=2.752126e-002; foe(n+1)=1.789120e+001; krok(n+1)=8.973318e-002; ng(n+1)=2.557665e+001;
n=64; farx(n+1)=2.548321e-002; foe(n+1)=1.656808e+001; krok(n+1)=2.957090e-001; ng(n+1)=5.892782e+000;
n=65; farx(n+1)=2.241121e-002; foe(n+1)=1.421145e+001; krok(n+1)=1.344350e-001; ng(n+1)=3.815836e+001;
n=66; farx(n+1)=2.107401e-002; foe(n+1)=1.193427e+001; krok(n+1)=2.002215e-001; ng(n+1)=3.403018e+000;
n=67; farx(n+1)=1.941548e-002; foe(n+1)=1.118410e+001; krok(n+1)=1.881319e-001; ng(n+1)=1.691250e+001;
n=68; farx(n+1)=1.866491e-002; foe(n+1)=9.747955e+000; krok(n+1)=6.774452e-002; ng(n+1)=2.724012e+001;
n=69; farx(n+1)=1.794649e-002; foe(n+1)=7.441889e+000; krok(n+1)=3.477470e-001; ng(n+1)=3.921505e+000;
n=70; farx(n+1)=1.720209e-002; foe(n+1)=6.218552e+000; krok(n+1)=1.634459e-001; ng(n+1)=8.043474e+000;
n=71; farx(n+1)=1.652517e-002; foe(n+1)=5.487593e+000; krok(n+1)=6.449478e-001; ng(n+1)=3.324093e+000;
n=72; farx(n+1)=1.522282e-002; foe(n+1)=4.503170e+000; krok(n+1)=1.248367e+000; ng(n+1)=7.836965e+000;
n=73; farx(n+1)=1.472321e-002; foe(n+1)=3.787227e+000; krok(n+1)=2.468205e-001; ng(n+1)=1.123741e+001;
n=74; farx(n+1)=1.422883e-002; foe(n+1)=3.511642e+000; krok(n+1)=2.962682e-001; ng(n+1)=1.156068e+001;
n=75; farx(n+1)=1.367471e-002; foe(n+1)=2.734332e+000; krok(n+1)=2.833785e-001; ng(n+1)=5.778694e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.366517e-002; foe(n+1)=2.721322e+000; krok(n+1)=1.386696e-005; ng(n+1)=3.691656e+000;
n=77; farx(n+1)=1.359241e-002; foe(n+1)=2.754605e+000; krok(n+1)=6.082834e-004; ng(n+1)=1.496188e+000;
n=78; farx(n+1)=1.356650e-002; foe(n+1)=2.738935e+000; krok(n+1)=1.733806e-004; ng(n+1)=1.745993e+000;
n=79; farx(n+1)=1.348070e-002; foe(n+1)=2.742345e+000; krok(n+1)=2.368463e-003; ng(n+1)=9.740922e-001;
n=80; farx(n+1)=1.338116e-002; foe(n+1)=3.006781e+000; krok(n+1)=6.480489e-003; ng(n+1)=6.343449e-001;
n=81; farx(n+1)=1.331656e-002; foe(n+1)=3.086713e+000; krok(n+1)=2.047906e-002; ng(n+1)=4.902039e-001;
n=82; farx(n+1)=1.317270e-002; foe(n+1)=2.997129e+000; krok(n+1)=5.893163e-002; ng(n+1)=7.246284e-001;
n=83; farx(n+1)=1.309075e-002; foe(n+1)=3.081440e+000; krok(n+1)=6.345766e-002; ng(n+1)=2.884314e+000;
n=84; farx(n+1)=1.289340e-002; foe(n+1)=3.236573e+000; krok(n+1)=2.373843e-001; ng(n+1)=2.643847e+000;
n=85; farx(n+1)=1.251644e-002; foe(n+1)=3.687367e+000; krok(n+1)=3.556863e-001; ng(n+1)=5.506889e+000;
n=86; farx(n+1)=1.203891e-002; foe(n+1)=3.937864e+000; krok(n+1)=3.805404e-001; ng(n+1)=1.689067e+001;
n=87; farx(n+1)=1.181055e-002; foe(n+1)=3.543735e+000; krok(n+1)=3.136529e-001; ng(n+1)=1.973763e+000;
n=88; farx(n+1)=1.168191e-002; foe(n+1)=3.457723e+000; krok(n+1)=3.134036e-001; ng(n+1)=4.445072e+000;
n=89; farx(n+1)=1.130850e-002; foe(n+1)=3.944249e+000; krok(n+1)=4.326251e-001; ng(n+1)=5.664658e-001;
n=90; farx(n+1)=1.106730e-002; foe(n+1)=4.089074e+000; krok(n+1)=4.208968e-001; ng(n+1)=8.948485e+000;
n=91; farx(n+1)=1.078941e-002; foe(n+1)=3.712688e+000; krok(n+1)=3.355407e-001; ng(n+1)=6.508052e+000;
n=92; farx(n+1)=1.054401e-002; foe(n+1)=3.602140e+000; krok(n+1)=4.288049e-001; ng(n+1)=4.224835e+000;
n=93; farx(n+1)=1.035520e-002; foe(n+1)=3.356385e+000; krok(n+1)=5.281352e-001; ng(n+1)=4.070693e+000;
n=94; farx(n+1)=1.022913e-002; foe(n+1)=3.137868e+000; krok(n+1)=3.589327e-001; ng(n+1)=3.940415e+000;
n=95; farx(n+1)=1.004201e-002; foe(n+1)=3.059967e+000; krok(n+1)=6.193808e-001; ng(n+1)=6.663797e+000;
n=96; farx(n+1)=9.718906e-003; foe(n+1)=2.856916e+000; krok(n+1)=1.987544e+000; ng(n+1)=2.356263e+000;
n=97; farx(n+1)=9.422802e-003; foe(n+1)=2.595882e+000; krok(n+1)=6.843317e-001; ng(n+1)=1.038281e+000;
n=98; farx(n+1)=9.210400e-003; foe(n+1)=2.604548e+000; krok(n+1)=4.095418e-001; ng(n+1)=6.996964e+000;
n=99; farx(n+1)=9.101132e-003; foe(n+1)=2.678745e+000; krok(n+1)=1.464436e-001; ng(n+1)=7.793409e+000;
n=100; farx(n+1)=8.969940e-003; foe(n+1)=2.766949e+000; krok(n+1)=3.550835e-001; ng(n+1)=3.080681e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
